# Letterbox Lab

一个在浏览器中完成"裁切 + 遮幅 + 水印"的轻量级图片处理工具。无需安装，打开 HTML 文件即可使用。

![Version](https://img.shields.io/badge/version-1.0-blue)
![License](https://img.shields.io/badge/license-MIT-green)

## ✨ 功能特性

### 📥 导入
- 支持拖拽图片到指定区域
- 支持点击选择文件导入
- 实时显示图片信息（文件名、尺寸）

### ✂️ 裁切
- 可选开关：支持关闭裁切功能
- **多种裁切比例**：
  - 自由比例（无约束）
  - 1:1（正方形）
  - 4:3（经典照片比例）
  - 16:9（宽屏比例）
  - 2.39:1（电影级宽屏）
- 可视化裁切框，支持八点拖拽调整
- 三分法辅助线
- 应用裁切后直接替换当前图像
- 重置裁切功能

### 🎬 遮幅比例
- **预设电影级比例**：
  - 2.39:1 (CinemaScope)
  - 2.35:1
  - 2.00:1 (Univisium)
  - 1.85:1
  - 1.78:1 (16:9)
- **自定义比例**：支持手动输入宽高比
- 自动计算上下/左右遮幅大小
- 实时预览遮幅效果

### 🎨 样式控制
- **图片上下偏移**：范围 -50% 至 +50%
- **遮幅颜色**：完全自定义颜色选择器
- **遮幅不透明度**：0-100% 可调

### 🏷️ 水印
- 支持 PNG 透明水印
- **位置控制**：
  - 水平偏移：-50% 至 +50%
  - 垂直偏移：-50% 至 +50%
- **缩放控制**：10% 至 300%
- **不透明度控制**：0% 至 100%
- 实时显示水印信息（文件名、尺寸、大小）

### 💾 导出
- 一键下载 PNG 格式
- 保持原图尺寸输出
- 遮幅以覆盖层形式叠加
- 自动生成文件名（原文件名-letterbox.png）

## 🚀 快速开始

### 方法 1：直接打开
```bash
# 双击打开 Letterbox_tool.html 文件
```

### 方法 2：本地服务器
```bash
# 使用 Python 启动简单 HTTP 服务器
python -m http.server 8000

# 或使用 Node.js
npx http-server
```

然后在浏览器中访问 `http://localhost:8000/Letterbox_tool.html`

## 📖 使用指南

1. **导入图片**  
   拖拽图片到"导入"区域，或点击选择文件

2. **裁切（可选）**  
   - 勾选"是否裁切"开关
   - 选择裁切比例或使用自由比例
   - 拖拽裁切框调整区域
   - 点击"应用裁切"确认（会替换当前图像）
   - 如需重新调整，点击"重置裁切"

3. **选择遮幅比例**  
   - 从下拉菜单选择预设比例
   - 或选择"自定义"输入特定比例
   - 实时查看遮幅效果

4. **调整样式**  
   - 使用"图片上下偏移"滑块调整图片位置
   - 点击颜色选择器修改遮幅颜色
   - 调整不透明度控制遮幅深浅

5. **添加水印（可选）**  
   - 勾选"增加水印"开关
   - 选择 PNG 水印文件
   - 调整水平/垂直偏移
   - 调整缩放比例
   - 调整不透明度

6. **导出**  
   点击"下载 PNG"按钮即可保存处理后的图片

## 📁 项目结构

```
.
├── Letterbox_tool.html    # 主界面 HTML 文件
├── app.js                 # 核心逻辑
│   ├── 图片处理（裁切、绘制）
│   ├── Canvas 渲染引擎
│   ├── 遮幅计算与绘制
│   ├── 水印处理
│   └── 交互控制（拖拽、调整）
├── styles.css             # 界面样式
│   ├── 暗色主题设计
│   ├── 渐变背景特效
│   ├── 响应式布局
│   └── 组件样式
└── README.md              # 项目说明文档
```

## 🎨 技术特点

- **纯前端实现**：无需后端服务器，完全在浏览器中运行
- **Canvas 绘图**：使用 HTML5 Canvas API 进行高性能图像处理
- **实时预览**：所有调整立即显示在预览区域
- **响应式设计**：支持不同屏幕尺寸
- **高精度处理**：支持设备像素比（DPR），确保高清输出
- **零依赖**：不依赖任何第三方库或框架

## 🖥️ 浏览器兼容性

建议使用以下现代浏览器的最新版本：

- ✅ Google Chrome (推荐)
- ✅ Microsoft Edge
- ✅ Safari
- ✅ Firefox

## 💡 使用技巧

1. **裁切与遮幅的区别**
   - 裁切：物理剪切图片，改变图片尺寸
   - 遮幅：在图片上覆盖黑边，不改变原图尺寸

2. **最佳工作流程**
   - 先裁切（如需要）
   - 再应用遮幅
   - 最后添加水印

3. **导出尺寸**
   - 导出图片尺寸与当前显示的图片一致
   - 如果应用了裁切，导出尺寸为裁切后的尺寸
   - 遮幅不会改变导出尺寸，只是添加覆盖层

4. **水印建议**
   - 使用 PNG 格式的透明背景水印效果最佳
   - 建议水印缩放比例在 50-150% 之间
   - 不透明度 60-80% 既可见又不会过于抢眼

## 🔧 开发说明

### 核心模块

**状态管理（State）**
```javascript
state = {
  image,           // 当前图片对象
  cropEnabled,     // 裁切开关
  cropAspect,      // 裁切比例
  cropRect,        // 裁切区域
  barRatio,        // 遮幅比例
  watermarkImage,  // 水印图片
  // ... 其他状态
}
```

**核心函数**
- `handleImage()`: 处理图片导入
- `draw()`: Canvas 绘制主函数
- `computeBars()`: 计算遮幅尺寸
- `applyCrop()`: 应用裁切
- `downloadImage()`: 导出图片

### 自定义修改

如需修改默认设置，可编辑 `app.js` 中的初始状态：

```javascript
// 默认遮幅比例
state.barRatio = 2.39;

// 默认遮幅颜色
state.barColor = "#0b0b0b";

// 默认水印不透明度
state.watermarkOpacity = 0.8;
```


---

